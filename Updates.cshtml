@{
    Layout = "~/_SiteLayout.cshtml";
    Page.Title = "Updates";    

    
        var needID = UrlData[0];
        var id = 0;
        if (!needID.IsEmpty() && needID.IsInt()) {
            id = Convert.ToInt32(needID);
        }
    
    

    var db = Database.Open("GoodStarter");
    var needInfo = db.QuerySingle("SELECT CreatorID, NeedTitle FROM Need WHERE NeedID = @0", id);
    var userInfo = db.QuerySingle("SELECT * FROM UserProfile WHERE UserId = @0", needInfo.CreatorID);
    var updatePosts = db.Query("SELECT * FROM Updates WHERE NeedID = @0 ORDER BY PostDate DESC", id);
}

<div class="row">
    <h1 class="page-title">@needInfo.NeedTitle</h1>
</div>
<div class="row">
    <div class="title-creator-info col-md-4">
        <img class="creator-img float-left" src="~/Images/@userInfo.Picture" alt="" />
        <h3 class="float-left">@userInfo.FirstName @userInfo.LastName</h3>
    </div>
    <div class="need-nav col-md-offset-2 col-md-6">
        <ul class="float-right">
            <li><a href="Need"><i class="fa fa-home"></i> Home</a>
            </li>
            <li><a href="Comments"><i class="fa fa-pencil-square-o"></i> Comments</a>
            </li>
            <li><a href="Updates"><i class="fa fa-cloud-upload"></i> Updates</a>
            </li>
        </ul>
    </div>
</div>

<section class="description">
    <div class="row">
        <div class="col-md-8">
            @foreach (var update in updatePosts) {
                <div class="updates">
                    <div class="sub-title row">
                        <h2 class="float-left"> @update.Title </h2>
                        <p class="float-right"> @update.PostDate </p>
                    </div>
                    <p> @update.Text </p>
                </div>
            }
        </div>
        <div class="col-md-4">
            <div class="need-stats">
                <h4><span class="stat-num">2</span> Need Meeters</h4>
                <h4><span class="stat-num">9</span> Days to Go</h4>
                <h4><span class="stat-num">14</span> Watching</h4>
                <div class="meet-need-button">Meet Need</div>
            </div>
        </div>
    </div>
    </div>
</section>